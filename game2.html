<head>
    <meta charset="utf-8" />
    <title>Game of Life</title>
    <style>
        * { padding: 0; margin: 0; }
        canvas { background: #eee; display: block; margin: 0 auto; }
    </style>
</head>
<body>

<canvas id="myCanvas2" width="600" height="600"></canvas>
<script>

    var canvas = document.getElementById("myCanvas2");
    var ctx = canvas.getContext("2d");

    var rows = 59
    var columns = 59

    function drawGrid() {
        var grid = []
        for(var i=0; i<(rows)*10 + 1; i++) {
            grid[i] = [];
            for(var j=0; j<columns + 1; j++) {
                grid[i][j] = { x: i, y: j*10 }
                
                ctx.beginPath();
                ctx.rect(grid[i][j].x,grid[i][j].y,1,1)
                ctx.rect(grid[i][j].y,grid[i][j].x,1,1)
                ctx.fillStyle ="black";
                ctx.fill();
                ctx.closePath();
            }

        }
    }

    var squares = [];
    for(var i=0; i<rows ; i++) {
        squares[i] = [];
        for(var j=0; j<columns; j++) {
            squares[i][j] = { x: i*10, y: j*10, status: 0, status2: 0}
            
        }
    
    }
    var gridColour = "#969696";
    var blockColour = "black";
    function drawArray() {
        
        for(var i=0; i<rows; i++) {
            for (var j=0; j<columns; j++){
                
                
                ctx.beginPath();
                ctx.rect(squares[i][j].x,squares[i][j].y,10,10)
                if (squares[i][j].status === 0) {
                    ctx.fillStyle = gridColour;
                } else if (squares[i][j].status === 1) {
                    ctx.fillStyle = blockColour;
                }
                
                ctx.fill();
                ctx.closePath();
            }
        }
    }
    

    document.addEventListener('click', detectClick)

    function detectClick() {

        var i = Math.round(Math.round(event.offsetX - 7)/10);
        var j = Math.round(Math.round(event.offsetY - 7)/10);
        //console.log("i: " + i + " mouse offset X: " + event.offsetX + " j: " + j + " mouse offset Y: " + event.offsetY )

        if(squares[i][j].status === 1) {
            squares[i][j].status = 0;
        } else if(squares[i][j].status === 0) {
            squares[i][j].status = 1;
        }
        drawArray();
        drawGrid();
        
            
        
    }
    
    document.addEventListener('keypress', gameLoop)
    function gameLoop() {
        for(var i=0; i<rows; i++) {
            for (var j=0; j<columns; j++){
                var lifeCount = 0
                
                if((i-1) > -1 && (j-1) > -1 && squares[i-1][j-1].status === 1) {
                    lifeCount += 1;
                }

                if((j-1) > -1 && squares[i][j-1].status === 1) {
                    lifeCount += 1;
                }

                if((j-1) > -1 && (i+1) < 59 && squares[i+1][j-1].status === 1) {
                    lifeCount += 1;
                }

                if((i-1) > -1 && squares[i-1][j].status === 1) {
                    lifeCount += 1;
                }

                if((i+1) < 59 && squares[i+1][j].status === 1) {
                    lifeCount += 1;
                }

                if((i-1) > -1 && (j+1) < 59 && squares[i-1][j+1].status === 1) {
                    lifeCount += 1;
                }
                
                if((j+1) < 59 && squares[i][j+1].status === 1) {
                    lifeCount += 1;
                }

                if((j+1) < 59 && (i+1) < 59 && squares[i+1][j+1].status === 1) {
                    lifeCount += 1;
                }

                if(lifeCount < 2) {
                    squares[i][j].status2 = 0;
                }
                if(lifeCount === 2) {
                    squares[i][j].status2 = squares[i][j].status;
                }
                if(lifeCount === 3) {
                    squares[i][j].status2 = 1;
                }
                if(lifeCount > 3) {
                    squares[i][j].status2 = 0;
                }
                
            }
        }
        for(var i=0; i<rows; i++) {
            for (var j=0; j<columns; j++){
                squares[i][j].status = squares[i][j].status2
            }
        }                
        drawArray();
        drawGrid();
    }

    drawArray();
    drawGrid();


    
    function randomizeGrid() {
        for(var i=0; i<rows; i++) {
            for (var j=0; j<columns; j++){
                squares[i][j].status = Math.round(Math.random());
                
            }
        }         
    }

    /*function mainLoop() {
    ctx.clearRect(0,0,rows,columns)
    drawArray();
    drawGrid();

    }
    */
    
    //var interval = setInterval(gameLoop, 10)
    var speed = 120;
    var interval

</script>
<button onclick="interval = setInterval(gameLoop, speed);">Start</button> 
<button onclick="clearInterval(interval);">Stop</button> 
<button onclick="randomizeGrid()">Randomize</button> 
<button onclick="randomizeGrid()">Colour Scheme</button> 
</body>

